<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FAT32 Image Defragmenter: dev/#gpl/defrag/src/disk.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FAT32 Image Defragmenter&#160;<span id="projectnumber">0.1b</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('disk_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">dev/#gpl/defrag/src/disk.c File Reference</div>  </div>
</div>
<div class="contents">

<p>The module simulates physical disk operations (through image file).  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a30c0603a742257d7400cf0c860cda11f">d_mount</a> (int image_descriptor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a92d5a3b61c6416fb3655a3de8c06b4ea">d_umount</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#aa6db633a63755ad0ed25fa05f68d5bcc">d_mounted</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#af84b601d7e78b7f3fccc010d1fc7e8a7">d_readSectors</a> (unsigned long LBAaddress, void *buffer, unsigned short count, unsigned short BPSector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a05be2b96a0105e77513c86b9163187e4">d_writeSectors</a> (unsigned long LBAaddress, void *buffer, unsigned short count, unsigned short BPSector)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#ab10cc5a1a97e3f96a63a67ea7999f90d">disk_descriptor</a> = 0</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The aim was to write independent module for controlling physical disk operations that is possible to rewrite in future also for real disk usage without modification needs of other modules. There are implemented some basic functions, such as disk mount (assigning a file descriptor), loading/storing some sectors. These functions are implemented in a way that every disk change is only movement of a pointer into the image file, given by file descriptor called disk_descriptor and on given location they perform the operations. </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a30c0603a742257d7400cf0c860cda11f"></a><!-- doxytag: member="disk.c::d_mount" ref="a30c0603a742257d7400cf0c860cda11f" args="(int image_descriptor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int d_mount </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>image_descriptor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function mounts disk image (i.e. assigns the parameter into global variable disk_descriptor) </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">image_descriptor</td><td>This parameter will be assigned into disk_descriptor variable </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a92d5a3b61c6416fb3655a3de8c06b4ea"></a><!-- doxytag: member="disk.c::d_umount" ref="a92d5a3b61c6416fb3655a3de8c06b4ea" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int d_umount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Un-mounting disk image, the descriptor is zero-ed. </p>

</div>
</div>
<a class="anchor" id="aa6db633a63755ad0ed25fa05f68d5bcc"></a><!-- doxytag: member="disk.c::d_mounted" ref="aa6db633a63755ad0ed25fa05f68d5bcc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int d_mounted </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The function determines if the disk is mounted </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the disk is mounted, return 1, or 0 otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="af84b601d7e78b7f3fccc010d1fc7e8a7"></a><!-- doxytag: member="disk.c::d_readSectors" ref="af84b601d7e78b7f3fccc010d1fc7e8a7" args="(unsigned long LBAaddress, void *buffer, unsigned short count, unsigned short BPSector)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short d_readSectors </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>LBAaddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>BPSector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The function reads 'count' sectors from the image of LBA logicall address into buffer </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">LBAaddress</td><td>logical LBA address, from that we should read sectors </td></tr>
    <tr><td class="paramname">buffer</td><td>into this buffer the sectors' data are written to </td></tr>
    <tr><td class="paramname">count</td><td>number of sectors that should be read </td></tr>
    <tr><td class="paramname">BPSector</td><td>Number of bytes per sector </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of really read sectors </dd></dl>

</div>
</div>
<a class="anchor" id="a05be2b96a0105e77513c86b9163187e4"></a><!-- doxytag: member="disk.c::d_writeSectors" ref="a05be2b96a0105e77513c86b9163187e4" args="(unsigned long LBAaddress, void *buffer, unsigned short count, unsigned short BPSector)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short d_writeSectors </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>LBAaddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>BPSector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The function writes 'count' sectors into the file disk image on the logical LBA address from buffer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">LBAaddress</td><td>logical LBA address, where we should write sectors </td></tr>
    <tr><td class="paramname">buffer</td><td>from this buffer the data will be read </td></tr>
    <tr><td class="paramname">count</td><td>number of sectors that should be written </td></tr>
    <tr><td class="paramname">BPSector</td><td>Number of bytes per sector </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of really written sectors </dd></dl>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ab10cc5a1a97e3f96a63a67ea7999f90d"></a><!-- doxytag: member="disk.c::disk_descriptor" ref="ab10cc5a1a97e3f96a63a67ea7999f90d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="disk_8c.html#ab10cc5a1a97e3f96a63a67ea7999f90d">disk_descriptor</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Descriptor of file image </p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="disk_8c.html">disk.c</a>      </li>
      <li class="footer">Generated on Tue Apr 26 2011 11:33:24 for FAT32 Image Defragmenter by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
